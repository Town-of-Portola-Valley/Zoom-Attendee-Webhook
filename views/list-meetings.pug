include mixins/time

mixin meetingList(type, meetings)
    div.card(class='list-group-item')
        h2(class='card-header') #{type}
        if meetings.length
            div(class='list-group list-group-numbered')
                each meeting in meetings
                    a(class='list-group-item list-group-item-action' href='meeting/' + meeting.MeetingID)
                        div(class='d-flex w-100 justify-content-between align-items-start')
                            div(class='d-flex align-items-start')
                                h4(class='link-primary') #{meeting.MeetingTitle}
                                case meeting.ParticipationCount
                                    when 0: span.badge(class='mx-2 my-1 bg-danger') Ended
                                    when 1: span.badge(class='mx-2 my-1 bg-info text-dark') 1
                                    default: span.badge(class='mx-2 my-1 bg-primary') #{meeting.ParticipationCount}
                            p.small(class='lh-1 fw-lighter') Updated:
                                +time(meeting.LastUpdatedAt)
                        if meeting.ParticipationCount
                            p(class='mb-1 lh-1') Started:
                                +time(meeting.MeetingStartTime)
                            p.small(class='lh-1 fw-lighter') Scheduled end:
                                +time(meeting.MeetingStartTime.plus(meeting.MeetingDuration))
                        else
                            p(class='mb-1 lh-1') Ended:
                                +time(meeting.LastUpdatedAt)
                            p.small(class='lh-1 fw-lighter') Started:
                                +time(meeting.MeetingStartTime)
        else
            div(class='card-body') &mdash; None &mdash;

doctype html
html
    head
        title #{page.title}
        meta(name='viewport' content='width=device-width, initial-scale=1')
        style
            include ../css/style.css
    body
        h1(class='my-2 text-center') #{page.title}
        div(class='list-group-flush')
            each meetingGroup in meetings
                +meetingList(meetingGroup.title, meetingGroup.meetings)
        div(class='d-flex w-100 justify-content-between')
            a(target='_blank' href='https://github.com/Town-of-Portola-Valley/Zoom-Attendee-Webhook' class='fw-lighter mx-3 mb-1') Site Source Code
            a(target='_blank' href='https://github.com/Town-of-Portola-Valley/Zoom-Attendee-Webhook/issues' class='fw-lighter mx-3 mb-1') Feedback
            small(class='fw-lighter mx-3 mb-1') Version: #{page.version}
